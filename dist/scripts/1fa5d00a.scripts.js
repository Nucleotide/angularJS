"use strict";var app=angular.module("frontendApp",[]);app.config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]);var app=angular.module("frontendApp");app.factory("Blogs",["$http",function(a){var b="https://ng-project-backend.herokuapp.com/api/blogs",c={};return c.all=function(){return a.get(b+".json")},c.create=function(c){return console.log("called"),a.post(b+".json",c)},c.delete=function(c){return a.delete(b+"/"+c.id+".json",c)},c}]),app.factory("Auth",["$http",function(a){var b="http://ng-project-backend.herokuapp.com/session",c={};return c.logged={},c.login=function(d){return a.post(b,d).then(function(b){return c.logged.status=!0,c.logged.user=d.user,a.defaults.headers.common["auth-token"]=b.data,b.data})},c.logout=function(){return a.delete(b).then(function(){return c.logged.status=!1,c.logged.user=null,delete a.defaults.headers.common["auth-token"],null})},c}]),app.controller("MainCtrl",["$scope","Blogs","Auth",function(a,b,c){a.loggedIn=c.logged,a.logout=function(){c.logout()},a.login=function(){c.login(a.credentials).then(function(a){console.log(a)},function(){}),a.credentials={}},a.formVisible=!1,b.all().success(function(b){a.entries=b,console.log(b)}),a.createBlog=function(){b.create(a.blog).success(function(b){a.entries.push(b)}),a.flash="Luonti "+a.blog.subject+" onnistui!",a.formVisible=!1,a.blog={}},a.deleteBlog=function(c){b.delete(c).success(function(){var b=a.entries.indexOf(c);a.entries.splice(b,1)})}}]);